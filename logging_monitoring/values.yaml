alertmanager:
  config:
    global:
      smtp_smarthost: 'smtp.gmail.com:587'
      smtp_from: '{{ .Values.alertmanager.smtp.from }}'
      smtp_auth_username: '{{ .Values.alertmanager.smtp.username }}'
      smtp_auth_password_file: '/etc/alertmanager/secrets/alertmanager-config/smtp_password'
      smtp_require_tls: true
    route:
      receiver: 'null'  # Default receiver - no notifications
      group_by: ['alertname']
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 24h
      routes:
        # Only send emails for alerts with type=homelab label
        - receiver: 'email-alerts'
          match:
            type: homelab
    receivers:
      - name: 'null'
        # No configuration = no notifications sent
      - name: 'email-alerts'
        email_configs:
          - to: '{{ .Values.alertmanager.smtp.to }}'
            send_resolved: false
  alertmanagerSpec:
    secrets:
      - alertmanager-config

prometheus:
  prometheusSpec:
    ruleSelector:
      matchLabels:
        release: prometheus
